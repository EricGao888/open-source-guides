# 开源标准以保护业务

随着企业成长逐步成长和扩大规模，企业的商业模型往往已经非常复杂，甚至并不只是依靠软件服务来盈利。此时的企业软件生态当中，错综复杂地依赖了一系列开源软件，因此企业主要出于保护现存业务，顺带扩大技术影响力，就有可能会以开源软件协议公开企业内部的关键软件，以夺取开源世界对应业务领域的标准。

出于这一动机实践开源的典型企业就是谷歌。无论是 Kubernetes 还是 Istio 的开源，谷歌从中获得的直接商业利润都是不足以促成它做这样的动作的。然而，谷歌通过对自己内部业务应用的分析，看出容器技术和云原生应用是未来业务发展的方向。为了保护公司内部所有基于 Kubernetes 同类云平台的业务能够持续得到新生代工程师的认同和维护，谷歌需要占领云原生标准的话语权。

这里有段逸闻想必同行也耳熟能详，说当初谷歌找上 Docker 希望合作开发容器调度平台，但是 Docker 认为自己单独开发 Docker Swarm 也能赢下容器战争。结局大家也都知道了，Kubernetes 赢下了容器战争，Docker Swarm / Apache Mesos / OpenStack / Cloud Foundry 等等当初的对手则黯然退场乃至彻底死亡。

相关技术被潮流所抛弃对采用这些技术的企业和团队带来的打击是非常严重的。不仅仅是押宝相应技术的团队被市场所否定，就业前景黯淡，对于公司来说，这意味着可能几十万行、上百万行乃至更多的业务代码都成了技术债务。站在今天的角度能够看到的例子，就是欧美国家银行当中海量的 COBOL 语言写成的业务系统，如今能找到的有维护能力的工程师最年轻的也有六十岁以上。如果这个世界上能够维护这些系统的工程师已经绝迹，那么企业的业务就暴露在巨大的风险之下。显然，当初选择了 Docker Swarm 和 Apache Mesos 的企业也将面临越来越招不到人维护的处境。在这种情况下，唯一能做的就是及时将遗留系统迁移到上游标准，但是这样的工作往往需要更加精通被淘汰的技术的工程师才能牵头完成，并且相应的时间精力成本不可估量。如果迁移这么简单，那些 COBOL 代码又是怎么历经几十年都无人能够“迁移”的呢？

不仅仅是容器战争这样出圈的开源标准之争，Yahoo! 开源 Apache ZooKeeper 和 Apache Pulsar 等软件，阿里开源 Apache RocketMQ 和全面投入 Apache Flink 的开发，Netflix 开源 Apache Curator 和 Apache Iceberg 以及 Uber 开源 Apache Hudi 等等，都有保护自己线上业务的动机在里面。当然，如果能够借此机会树立公司的技术品牌，吸纳高水平的技术人才，乃至主导行业未来的发展方向，那就是意外之喜了。

不完全是软件行业为了保护现存业务，在开源技术以争夺行业标准的方向上，还有三个值得一提的案例。

第一个是启发我从这个方向看待企业实践开源的动机的例子。Bjarne Stroustrup 在 2020 年总结 C++ 发展历程的论文 [Thriving in a Crowded and Changing World: C++ 2006–2020](https://www.stroustrup.com/hopl20main-p5-p-bfc9cd4--final.pdf) 当中提到了 C++ 标准委员会当中有许多耳熟能详的大公司的参与，包括苹果、谷歌、英特尔、微软、摩根士丹利、英伟达、高通、红帽和 IBM 等等。每个提案提出的时候，往往代表了某个公司或科研机构经年的努力、实践和生产检验。论文当中回顾了若干提案导致不同硬件厂商的标准之争、大学科研机构的方向之争和软件公司保护现存业务不受完全不同的标准的影响的争论。

例如，各家都有自己的协程实现和用例，如果标准库的实现与自家实现的关键设计和接口不同，那么就意味着以上游的分叉，这将导致上面提到的实现被开源社群所抛弃或者巨大的迁移成本的问题。对于硬件厂商来说，类似于 C/C++ 这样的系统编程语言是硬件接口接入软件层面第一个要打交道的层次。如果在并发语义、时钟接口或者硬件访问标准上采取了一家硬件厂商的方案，那么其他硬件厂商的众多生产流水线就面临立即被市场淘汰的风险，以及成为相应细分领域追随者而不是领导者或公平竞争者的劣势。

第二个是谷歌开源 Android 操作系统的例子。开发和开源 Android 操作系统之前，谷歌内部并没有大量的现存业务。但是众所周知，为了避免移动互联网时代的基础设施移动设备的操作系统被 iOS 全面统治，从而在谷歌和苹果的全面软件技术竞争上处于劣势，后发的谷歌选择开源的方式来开发自己的移动设备操作系统。谷歌在浏览器市场上也采用了类似的模式，谷歌浏览器的内核是开源的 [Chromium](https://www.chromium.org/chromium-projects/) 项目，这一选择或许受到了世纪初 Firefox 在与 IE 的竞争下赢得巨大成功的启示。不可否认的是，开源的 Android 操作系统形成的庞大生态，开源的 Chromium 内核衍生的一系列浏览器软件，成为了谷歌在这两个方向上核心技术极深的护城河，同时也极大地扩张了这两个领域的市场规模。

第三个例子是跨领域的特斯拉的例子。特斯拉进军新能源汽车领域时，这个领域的市场规模还很有限。即使特斯拉是行业当中无可争议的老大，新能源汽车在行业成熟度，全球化分工的可行性和社会认可度都是极其有限的。通过开源核心基础技术，不追究使用基础专利侵权，使得全球所有看到机会的人才投入到这个行业当中来。行业成熟度决定特斯拉能够持续地招聘到什么水平的人才。如果市场上只有特斯拉一家公司，那么选择这个方向的人心里就要打鼓，现在即使投身这个行业进不去特斯拉，或者特斯拉出现问题要调整或者裁员，也能找到其他岗位继续自己的职业生涯。如此，加上行业热情高涨，社会认可度高，人才投入到这一领域的概率和比例就大大增加了。另一个方面，社会认可度还可以增加大众购买新能源汽车的动力和信心，全球化分工则使得特斯拉的生产制造流水线能够放置到人力成本最经济的国家或地区完成。
